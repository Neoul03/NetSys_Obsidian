https://www.kernel.org/doc/html/next//scheduler/sched-eevdf.html
https://github.com/torvalds/linux/blob/master/Documentation/scheduler/sched-eevdf.rst

EEVDF(Earliest Eligible Virtual Deadline First) 스케줄러는 리눅스 커널 6.6 버전에서 도입된 새로운 CPU 스케줄링 알고리즘으로, 기존의 CFS(Completely Fair Scheduler)를 대체하거나 보완할 목적으로 설계되었다. 주요 목표는 응답성이 높은 작업에 대한 처리 성능을 개선하고, 시스템 내의 공정한 CPU 시간 분배를 유지하는 데 있다. 이 점에 있어서는 기존의 CFS 스케줄러와 동일한 목표를 갖고 있다. 
### EEVDF에서의 데드 라인

**프로세스가 주어진 시점 내에 특정 작업을 처리할 수 있어야 하는 기한**을 뜻한다. 이는 작업이 시작된 후 완료되어야 하는 시간까지를 특정하여, 해당 데드라인까지 작업이 완료될 수 있도록 스케줄링을 우선순위로 고려한다.

구체적으로, EEVDF에서는 각 작업에 대해 가상의 데드라인이 설정되며, 이 데드라인을 기준으로 작업들이 실행된다. 즉, 작업이 **언제까지 CPU를 할당받아야 하는지**를 설정하고, 해당 시간까지 완료되도록 우선 배치하는 방식이다. 이를 통해 실시간에 가까운 상호작용이 요구되는 환경에서 특정 작업을 우선적으로 처리함으로써 응답 시간을 보장할 수 있다.

따라서, 데드라인은 작업의 처리 시간을 제한하는 약속이라고 볼 수 있으며, 시스템은 이러한 기한을 준수하도록 스케줄링한다.

### EEVDF의 주요 특징

1. **가상 데드라인(Virtual Deadline)과 공정성(Fairness)**  
    EEVDF는 각 작업에 "가상 데드라인"을 할당하여 가장 빠른 데드라인을 가진 작업을 우선 실행하도록 한다. 이를 통해 실시간 처리가 필요한 작업을 우선시하면서도, CPU 시간을 각 작업의 요구에 맞춰 공정하게 분배하는 효과를 낸다.
    
2. **라그(Lag) 관리**  
    EEVDF는 각 작업이 공정하게 할당된 CPU 시간보다 더 많이 사용했는지(음수 라그) 혹은 덜 사용했는지(양수 라그)를 추적한다. 이를 통해 라그가 있는 작업을 우선순위로 둠으로써, 작업이 제시간에 CPU 시간을 얻을 수 있도록 조정하여 공정성을 유지한다.
    
3. **응답성 향상**  
    짧은 시간 동안 CPU를 사용하는 상호작용 작업의 경우, EEVDF는 이들을 더 빠르게 처리하여 응답 시간을 줄인다. 특히 사용자 입력이나 상호작용이 중요한 작업에서 빠른 반응을 제공하므로, 인터랙티브 애플리케이션에 적합하다.
    
4. **선점 제어**  
    EEVDF는 가상 데드라인을 기반으로 선점(preemption)을 유연하게 처리한다. CPU 사용 중인 작업이 더 빠른 데드라인을 가진 작업에 의해 선점될 수 있으므로, 다양한 요구 사항을 가진 작업이 혼재된 환경에서도 효율적으로 동작한다.
    
5. **슬립(Task Sleep)에 대한 지연 큐 처리**  
    슬립 모드로 전환된 작업이 비정상적으로 CPU 할당 시간을 조작하는 것을 방지하기 위해, 슬립에서 복귀하는 작업의 라그가 점진적으로 감소하도록 설정하여 공정성을 유지한다.
    

EEVDF 스케줄러는 공정한 CPU 시간 분배와 동시에 데드라인 기반의 우선 순위 처리를 결합하여, CPU 집약적인 작업과 상호작용이 중요한 작업이 공존하는 환경에서 효율적으로 동작하도록 설계되었다.


### 차이점(CFS vs EEVDF)

1. **기본 스케줄링 메커니즘**
    
    - **CFS**: CFS는 "가상 런타임(Virtual Runtime)" 개념을 사용하여 각 작업에 CPU 시간을 공정하게 배분한다. 각 작업이 실행되면서 증가하는 가상 런타임을 기반으로 스케줄링 큐에서 가장 작은 가상 런타임을 가진 작업을 선택하여 CPU를 할당한다.
    - **EEVDF**: EEVDF는 "가상 데드라인"과 "eligibility time"을 사용하여 가장 빠른 데드라인을 가진 작업을 우선적으로 처리한다. 이를 통해 긴급한 상호작용 작업(interactive application)이 지연 없이 실행될 수 있도록 한다.
    
2. **우선순위 결정 방식**
    
    - **CFS**: 모든 작업이 균등하게 CPU를 할당받는 공정성에 중점을 두며, 주로 가상 런타임을 기준으로 우선순위를 결정한다. 즉, CPU 사용 시간이 적은 작업이 더 높은 우선순위를 갖는다.
    - **EEVDF**: 각 작업의 데드라인을 기준으로 우선순위를 부여하므로, 데드라인이 더 이른 작업이 먼저 실행된다. 이를 통해 실시간 작업과 유사한 성격의 작업이 더욱 빠르게 처리될 수 있다.
    
3. **슬립 상태에 대한 처리**
    
    - **CFS**: 작업이 슬립 상태에 들어갔다가 깨어날 때, 해당 작업의 가상 런타임을 유지함으로써 전체 공정성을 유지하려 한다.
    - **EEVDF**: 슬립 상태에서 복귀한 작업의 라그(lag)를 점진적으로 조정하여, 슬립 후 다시 활성화된 작업이 시스템 전체 공정성에 큰 영향을 주지 않도록 한다.

4. **실시간 작업 지원**
    
    - **CFS**: 공정성 중심으로 설계되어 있으나 실시간 성능에 한계가 있다. 특히, 매우 짧은 응답 시간을 필요로 하는 상호작용형 작업에서는 응답 지연이 발생할 수 있다.
    - **EEVDF**: 데드라인 기반 스케줄링을 통해 상호작용형 작업을 더욱 빠르게 처리할 수 있도록 설계되어 실시간 성능이 더 뛰어나다. 이로 인해, 짧은 응답 시간이 필요한 작업에 적합하다.

5. **CPU 사용 모니터링**
    
    - **CFS**: 각 작업의 가상 런타임을 기준으로 CPU 사용을 모니터링하여 공정성을 유지한다.
    - **EEVDF**: 라그(lag) 값을 사용하여 각 작업의 CPU 사용이 할당된 데드라인에 얼마나 근접한지를 모니터링하고, 이를 기반으로 스케줄링 우선순위를 조정한다.


### EEVDF로 변경된 주요 동기
CFS에서 EEVDF로 변경된 주요 동기는 주로 **응답성 향상**과 **상호작용 작업 처리 성능 개선**에 있다. 리눅스의 기존 CFS(Completely Fair Scheduler)는 공정한 CPU 시간 분배에 초점을 맞춰 설계되었지만, 모든 작업을 공정하게 처리하는 접근 방식은 짧은 지연 시간과 높은 응답성이 필요한 상호작용형 또는 실시간 성격의 작업에서는 한계가 있었다. 이러한 응답성의 문제를 해결하기 위해, EEVDF(Earliest Eligible Virtual Deadline First) 스케줄링 방식이 도입되었다.

1. **실시간에 가까운 응답성 요구**:
    
    - CFS는 공정성을 기반으로 하지만, 실시간 응답성을 요구하는 상호작용형 애플리케이션에선 때때로 높은 지연이 발생할 수 있었다. CFS는 작업의 가상 런타임을 기준으로 CPU를 할당하여 모든 작업에 공정하게 시간 분배를 한다. 그러나, 특정 작업에 더 빠른 응답이 필요할 때 우선순위를 조정하기가 어렵다는 단점이 있었다.
    - EEVDF는 데드라인 기반의 스케줄링 방식을 사용하여 짧은 응답 시간을 보장할 수 있으며, 빠르게 처리해야 하는 상호작용 작업을 우선적으로 실행할 수 있게 해준다. 이를 통해 사용자 경험을 개선하고 시스템의 효율성을 높일 수 있다.
    
2. **상호작용형 작업의 성능 개선**:
    
    - 모바일 기기나 데스크탑 환경에서 사용자와의 상호작용이 잦은 작업(예: UI 응답성, 입력 대기 시간 등)은 매우 짧은 지연 시간과 빠른 반응 속도가 필요하다. CFS의 공정성 위주의 스케줄링은 이러한 작업의 성능을 보장하기에 한계가 있었으며, 대기 시간이 길어지는 경우도 있었다.
    - EEVDF는 특정 데드라인이 설정된 작업을 우선적으로 처리하므로, 사용자가 요청한 상호작용에 대해 즉각적인 응답이 가능하며 이러한 작업의 성능을 보장할 수 있다.
    
3. **효율적인 CPU 자원 관리**:
    
    - CFS는 모든 작업이 동일한 비율로 CPU 자원을 받도록 하는 공정성을 중시한다. 반면, EEVDF는 작업의 데드라인을 고려해 CPU 자원을 보다 효율적으로 분배하여 긴급한 작업이 빠르게 완료되도록 돕는다. 이를 통해 시스템의 응답성을 높이고, 특히 높은 우선순위를 가진 작업들이 필요한 시점에 즉시 CPU를 사용할 수 있도록 한다.
    
4. **멀티코어 환경에 적합**:
    
    - EEVDF는 멀티코어 시스템에서 각 작업의 적시성에 따라 CPU 코어를 효율적으로 할당할 수 있으며, 여러 코어를 활용하는 상호작용형 애플리케이션에 적합하다. 이러한 특성은 멀티코어 시스템의 성능을 최적화하는 데 유리하다.
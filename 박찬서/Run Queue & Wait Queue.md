리눅스에서 **Run Queue**와 **Wait Queue**는 스케줄러와 자원 관리의 핵심적인 역할을 수행하는 두 가지 주요 큐이다. 각 큐는 커널 수준에서 프로세스의 상태와 자원 접근을 관리하며, 프로세스 스케줄링의 흐름과 대기 상태를 제어하는 데 중요한 역할을 한다. 
### 1. **Run Queue**

Run Queue는 CPU가 실행할 준비가 완료된 모든 **Runnable(실행 가능한)** 프로세스의 리스트이다. 프로세스가 **실행 가능 상태**일 때 이 큐에 들어가며, 스케줄러는 이 큐에서 프로세스를 선택해 CPU에서 실행한다. 리눅스에서는 Run Queue가 **다단계 피드백 큐(Multi-Level Feedback Queue)로 구성되어 있다. 이는 우선순위 기반**의 큐로, 각 큐는 서로 다른 우선순위를 가지고 프로세스가 CPU를 사용할 시간을 결정한다.

#### 구조와 동작

- **구조**: 리눅스에서는 Run Queue가 여러 개의 큐로 나뉘어 있으며, 각 큐는 **Red-Black Tree(레드-블랙 트리)로 관리된다. 레드-블랙 트리는 효율적인 삽입, 삭제, 검색이 가능하여 O(log n)** 시간 내에 가장 적은 가중치를 가진 프로세스를 찾을 수 있다.
- **다단계 피드백 큐**: 우선순위가 높은 큐일수록 짧은 시간 퀀텀이 할당되며, 프로세스가 시간이 경과하면서 낮은 우선순위로 이동하게 된다. 이렇게 하여 CPU 시간이 공정하게 분배되도록 하고, 전체적인 시스템 응답성을 높인다.
- **CFS(Completely Fair Scheduler)**: 리눅스의 CFS는 모든 프로세스가 **공정하게** CPU를 사용할 수 있도록 하는 스케줄링 정책이다. CFS는 각 프로세스의 가상 런타임을 비교해 가장 낮은 가상 런타임을 가진 프로세스를 먼저 실행하도록 한다. 이 과정에서 Run Queue는 각 프로세스의 가상 런타임을 정렬하고, 가장 적은 런타임을 가진 프로세스를 선택하는 데 핵심 역할을 한다.
- **타임 슬라이스(Time Slice)**와 **가중치**: 각 프로세스는 타임 슬라이스를 통해 할당된 시간 동안 CPU를 사용하며, CFS는 프로세스 우선순위와 가중치에 따라 타임 슬라이스를 조절한다.

#### 주요 특징

- Run Queue는 프로세스가 **실행 대기** 상태에 놓일 때 스케줄러가 접근하는 큐이다.
- CFS의 경우 가상 런타임을 기반으로 프로세스의 공정한 실행을 보장한다.
- **다단계 피드백 큐**의 개념을 적용하여, 높은 응답성을 요구하는 작업이 우선적으로 처리될 수 있도록 한다.

### 2. **Wait Queue**

Wait Queue는 특정 자원에 접근이 불가능하거나, 특정 이벤트가 발생할 때까지 **대기 상태**에 있는 프로세스를 관리하는 큐이다. Wait Queue에 있는 프로세스들은 스케줄러가 이들을 실행시키지 않으며, 특정 조건이 충족될 때까지 **블록(blocked)** 상태로 남아 있다. 예를 들어, 파일 I/O를 대기 중이거나 네트워크 수신을 기다리는 프로세스들이 여기에 포함된다.

#### 구조와 동작

- **구조**: Wait Queue는 단일 리스트 형태로 구성되며, 각 항목은 **wait_queue_entry_t**라는 구조체로 표현된다. 이 구조체는 대기 중인 프로세스와 관련된 정보를 포함하고, wake-up 메커니즘과 연계되어 있다.
- **대기 상태 관리**: 프로세스가 자원을 사용할 수 없는 경우, 해당 프로세스는 Wait Queue에 추가되어 대기 상태로 전환된다. 이때 커널은 프로세스를 **슬립(sleep)** 상태로 전환시켜 자원을 절약하고, 조건이 충족될 때까지 대기시킨다.
- **Wake-up 메커니즘**: 특정 자원이나 이벤트가 준비되면 커널은 해당 Wait Queue에 있는 프로세스를 **깨워(run queue로 이동)** 실행 가능 상태로 전환시킨다. 일반적으로 이벤트가 발생하거나, 블로킹된 작업이 완료되면 **wake_up()** 함수가 호출되어 관련된 프로세스들을 다시 실행할 수 있도록 Run Queue로 이동시킨다.
- **조건 변수**: Wait Queue는 특정 조건이 발생할 때까지 대기하는 큐이기 때문에, 조건 변수와 결합하여 자원의 준비 상태를 관리할 수 있다. 이는 자원의 효율적인 사용과 프로세스 간의 동기화를 도와준다.

#### 주요 특징

- Wait Queue는 **블록 상태**에서 특정 조건이 만족될 때까지 대기하는 프로세스들을 관리한다.
- 자원이 준비되거나 이벤트가 발생하면 프로세스는 Wait Queue에서 Run Queue로 이동하여 실행된다.
- 커널 내부에서 다양한 I/O 및 시스템 이벤트 대기를 위한 주요 메커니즘으로 사용된다.
